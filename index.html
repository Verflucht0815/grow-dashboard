
 document.addEventListener('DOMContentLoaded', () => {
        // CONFIG HIER ANPASSEN!
        const CHANNEL_ID = 2999714;      // Deine ThingSpeak Channel ID
        const READ_API_KEY = '95YOHGB903ET32DX'; // Dein Read API Key
    let chart;

    function initChart() {
        const ctx = document.getElementById('myChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: { 
                datasets: [
                    { 
                        label: "Temperatur (°C)", 
                        borderColor: '#FF6384',
                        data: [] 
                    },
                    { 
                        label: "Luftfeuchtigkeit (%)", 
                        borderColor: '#36A2EB',
                        data: [] 
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    x: { 
                        type: 'time',
                        time: {
                            tooltipFormat: 'DD.MM HH:mm',
                            unit: 'hour'
                        }
                    }
                }
            }
        });
    }

    async function loadData(hours) {
        try {
            const response = await fetch(
                `https://api.thingspeak.com/channels/${CHANNEL_ID}/feeds.json?api_key=${READ_API_KEY}&results=${hours*6}`
            );
            const data = await response.json();
            
            chart.data.datasets[0].data = data.feeds.map(f => ({
                x: f.created_at,
                y: parseFloat(f.field1)
            }));
            chart.data.datasets[1].data = data.feeds.map(f => ({
                x: f.created_at,
                y: parseFloat(f.field2)
            }));
            
            chart.update();
        } catch (error) {
            console.error("Fehler:", error);
        }
    }

    // Event-Listener für Buttons
    document.querySelectorAll('.time-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const hours = parseInt(btn.textContent);
            loadData(hours);
        });
    });

    // Initialisierung
    initChart();
    loadData(24); // Start mit 24h-Daten
});
